<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>mitmproxy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>

<div id="mitmproxy"><h1 id="mitmproxy">mitmproxy</h1></div>

<p>
<a href="https://mitmproxy.org/">https://mitmproxy.org/</a>
</p>

<p>
代理服务器，可监控所有的过路流量，爬虫利器。
</p>

<p>
直接用 <code>pip</code> 安装，然后运行
</p>
<pre sh>
mitmproxy
</pre>

<p>
注意，如果允许远程访问，需要参考 <a href="https://docs.mitmproxy.org/stable/concepts-options/">https://docs.mitmproxy.org/stable/concepts-options/</a> ，
关闭 <code>block_global</code>。
</p>
<pre sh>
$ cat ~/.mitmproxy/config.yaml
block_global: false
listen_port: 58000
</pre>

<p>
各种快捷键类似 <code>vi</code>。
</p>

<div id="mitmproxy-信任证书"><h3 id="信任证书">信任证书</h3></div>

<p>
访问：
<a href="http://mitm.it/">http://mitm.it/</a>
</p>


<div id="mitmproxy-透传模式"><h3 id="透传模式">透传模式</h3></div>

<p>
使用这种模式，客户端就无需设置代理，所有网络请求都经过 mitmproxy。
</p>

<p>
用 Mac 做服务器比较简单，参考 <a href="https://docs.mitmproxy.org/stable/howto-transparent/#macos">https://docs.mitmproxy.org/stable/howto-transparent/#macos</a>
</p>

<p>
接下来，客户端配置 gateway 为 mitmproxy 所在的服务器的地址，就基本完成了网络设置，测一下效果吧。
</p>

<p>
附：
</p>
<pre sh>
mitmdump --mode transparent --showhost --ssl-insecure "!~a"
</pre>

<div id="mitmproxy-Windows 安装"><h3 id="Windows 安装">Windows 安装</h3></div>

<pre sh>
# edit %APPDATA%\pip\pip.ini
[global]
index-url = https://pypi.douban.com/simple
trusted-host = pypi.douban.com
format=columns

conda create --name mitm python=3.6
conda activate mitm
pip install mitmproxy
</pre>

</body>
</html>
